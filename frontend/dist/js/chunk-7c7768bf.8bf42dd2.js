(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c7768bf"],{"151a":function(t,e,a){"use strict";a("4e25")},"4b75":function(t,e,a){"use strict";a("7b87")},"4e25":function(t,e,a){},"76fe":function(t,e,a){"use strict";a.d(e,"j",(function(){return i})),a.d(e,"k",(function(){return l})),a.d(e,"l",(function(){return o})),a.d(e,"m",(function(){return n})),a.d(e,"n",(function(){return r})),a.d(e,"i",(function(){return c})),a.d(e,"g",(function(){return d})),a.d(e,"c",(function(){return h})),a.d(e,"h",(function(){return u})),a.d(e,"a",(function(){return p})),a.d(e,"e",(function(){return b})),a.d(e,"d",(function(){return m})),a.d(e,"b",(function(){return f})),a.d(e,"f",(function(){return v}));var s=a("b775");function i(){return Object(s["a"])({url:"/openlist",headers:{isMask:!1},method:"get"})}function l(t,e){return Object(s["a"])({url:"/openlist",headers:{isMask:!1},method:"get",params:{openlistId:t,path:e}})}function o(t){return Object(s["a"])({url:"/openlist",headers:{isMask:!1},method:"post",data:{...t,action:"mkdir"}})}function n(t){return Object(s["a"])({url:"/openlist",headers:{isMask:!1},method:"post",data:t})}function r(t){return Object(s["a"])({url:"/openlist",headers:{isMask:!1},method:"put",data:t})}function c(t){return Object(s["a"])({url:"/openlist",headers:{isMask:!1},method:"delete",data:{id:t}})}function d(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"post",data:t})}function h(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"get",params:t})}function u(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"put",data:t})}function p(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"delete",data:t})}function b(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"get",params:{...t,current:1}})}function m(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"get",params:t})}function f(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"delete",data:{taskId:t}})}function v(t){return Object(s["a"])({url:"/job",headers:{isMask:!1},method:"get",params:t})}},"7b87":function(t,e,a){},"7fbd":function(t,e,a){"use strict";a("9fef")},"8c11":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"menuRefresh"},[t._v("   "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.needShow>1,expression:"needShow > 1"}],staticClass:"refreshLabel"},[t._v(t._s(t.refreshText))]),e("el-switch",{directives:[{name:"show",rawName:"v-show",value:t.needShow>1,expression:"needShow > 1"}],on:{change:t.refreshChange},model:{value:t.refreshStatus,callback:function(e){t.refreshStatus=e},expression:"refreshStatus"}}),e("i",{directives:[{name:"show",rawName:"v-show",value:t.needShow>0,expression:"needShow > 0"}],class:(t.loading?"el-icon-loading":"el-icon-refresh-right")+" icon-btn",on:{click:t.refreshData}})],1)},i=[],l={name:"MenuRefresh",props:{loading:{type:Boolean,default:!1},autoRefresh:{type:Boolean,default:!0},freshInterval:{type:Number,default:3119},needShow:{type:Number,default:2},refreshText:{type:String,default:"自动刷新"}},data(){return{refreshStatus:!0,timer:null}},created(){this.refreshStatus=this.autoRefresh,this.refreshStatus?this.startRefresh():this.$emit("getData")},beforeDestroy(){this.destroy()},methods:{refreshChange(t){this.refreshStatus=t,t?this.startRefresh():this.destroy()},refreshData(){this.loading||this.$emit("getData")},startRefresh(){this.destroy(),this.$emit("getData"),this.timer=setInterval(()=>{this.$emit("getData")},this.freshInterval)},destroy(){this.timer&&clearInterval(this.timer)}}},o=l,n=(a("7fbd"),a("2877")),r=Object(n["a"])(o,s,i,!1,null,"554c6eda",null);e["a"]=r.exports},9960:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("div",{staticClass:"top-box"},[e("div",{staticClass:"top-box-left"},[e("el-button",{attrs:{type:"success",icon:"el-icon-plus",size:"small"},on:{click:t.addShow}},[t._v("新建作业")]),t.jobData.jobList.length>1?e("el-button",{attrs:{size:"small",icon:"el-icon-caret-right",loading:t.btnLoading,type:"primary"},on:{click:t.runAllJob}},[t._v("执行全部")]):t._e()],1),e("div",{staticClass:"top-box-title"},[t._v("作业管理")]),e("menuRefresh",{attrs:{autoRefresh:!1,freshInterval:5273,loading:t.loading},on:{getData:t.getJobList}})],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-data",attrs:{data:t.jobData.jobList,height:"calc(100% - 117px)"}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"form-box"},[e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 同步方式 ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(0==a.row.method?"仅新增":1==a.row.method?"全同步":"移动模式")+" ")])]),e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 目标目录扫描 ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(0==a.row.useCacheT?"不用缓存":"使用缓存")+"，操作间隔为 "+t._s(a.row.scanIntervalT)+" 秒 ")])]),e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 源目录扫描 ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(0==a.row.useCacheS?"不用缓存":"使用缓存")+"，操作间隔为 "+t._s(a.row.scanIntervalS)+" 秒 ")])]),e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 调用方式 ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(0==a.row.isCron?"间隔":1==a.row.isCron?"cron":"仅手动")+" ")])]),0==a.row.isCron?e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 同步间隔 ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(a.row.interval)+" 分钟 ")])]):1==a.row.isCron?t._l(t.cronList,(function(s){return e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" "+t._s(s.label)+" ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(a.row[s.label]||"-")+" ")])])})):t._e(),e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 排除项规则 ")]),e("div",{staticClass:"form-box-item-value"},[null==a.row.exclude?e("span",[t._v("-")]):t._l(a.row.exclude.split(":"),(function(a){return e("span",{staticClass:"exclude-item bg-3"},[t._v(" "+t._s(a)+" ")])}))],2)]),e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 创建时间 ")]),e("div",{staticClass:"form-box-item-value"},[t._v(" "+t._s(t._f("timeStampFilter")(a.row.createTime))+" ")])]),e("div",{staticClass:"form-box-item"},[e("div",{staticClass:"form-box-item-label"},[t._v(" 更多操作 ")]),e("div",{staticClass:"form-box-item-value"},[2!=a.row.isCron?[a.row.enable?e("el-button",{attrs:{type:"warning",loading:t.btnLoading,size:"mini"},on:{click:function(e){return t.disableJobShow(a.row,!1)}}},[t._v("禁用")]):e("el-button",{attrs:{type:"success",loading:t.btnLoading,size:"mini"},on:{click:function(e){return t.putJob(a.row,!1)}}},[t._v("启用")])]:t._e(),e("el-button",{attrs:{type:"danger",loading:t.btnLoading,size:"mini"},on:{click:function(e){return t.disableJobShow(a.row,!0)}}},[t._v("删除")]),e("el-button",{attrs:{type:"primary",loading:t.btnLoading,size:"mini"},on:{click:function(e){return t.editJobShow(a.row)}}},[t._v("编辑")])],2)])],2)]}}])}),e("el-table-column",{attrs:{prop:"remark",label:"名称",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.remark||"--")+" ")]}}])}),e("el-table-column",{attrs:{prop:"enable",label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{class:"bg-status bg-"+(a.row.enable?"2":"7"),staticStyle:{width:"50px"}},[t._v(" "+t._s(a.row.enable?"启用":"禁用")+" ")])]}}])}),e("el-table-column",{attrs:{prop:"srcPath",label:"来源目录","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"pathList"},[e("div",{staticClass:"pathBox bg-8"},[t._v(t._s(a.row.srcPath))])])]}}])}),e("el-table-column",{attrs:{prop:"dstPath",label:"目标目录","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"pathList"},t._l(a.row.dstPath.split(":"),(function(a){return e("div",{staticClass:"pathBox bg-1"},[t._v(t._s(a))])})),0)]}}])}),e("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{icon:"el-icon-caret-right",type:"primary",loading:t.btnLoading,size:"mini"},on:{click:function(e){return t.putJob(a.row)}}},[t._v("手动执行")]),e("el-button",{attrs:{icon:"el-icon-view",type:"success",loading:t.btnLoading,size:"mini"},on:{click:function(e){return t.detail(a.row.id)}}},[t._v("详情")])]}}])})],1),e("div",{staticClass:"page"},[e("el-pagination",{attrs:{"current-page":t.params.pageNum,"page-size":t.params.pageSize,total:t.jobData.count,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100]},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{top:"5vh","close-on-click-modal":!1,visible:t.editShow,"append-to-body":!0,title:(t.editData&&null!=t.editData.id?"编辑":"新增")+"作业",width:"820px","before-close":t.closeShow},on:{"update:visible":function(e){t.editShow=e}}},[e("div",{staticClass:"elform-box"},[t.editShow?e("el-form",{ref:"jobRule",attrs:{model:t.editData,rules:t.addRule,"label-width":"150px"}},[e("div",{staticStyle:{display:"flex","flex-wrap":"wrap"}},[e("el-form-item",{attrs:{prop:"enable",label:"是否启用"}},[e("div",{staticClass:"label_width"},[2!=t.editData.isCron?e("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.editData.enable,callback:function(e){t.$set(t.editData,"enable",e)},expression:"editData.enable"}}):e("span",[t._v("启用")])],1)]),e("el-form-item",{attrs:{prop:"openlistId",label:"引擎"}},[e("el-select",{staticClass:"label_width",attrs:{placeholder:"请选择引擎","no-data-text":"暂无引擎,请前往引擎管理创建"},model:{value:t.editData.openlistId,callback:function(e){t.$set(t.editData,"openlistId",e)},expression:"editData.openlistId"}},t._l(t.openlistList,(function(a){return e("el-option",{attrs:{label:a.url,value:a.id}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v(t._s(a.url)+t._s(null!=a.remark?`[${a.remark}]`:""))]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v(t._s(a.userName))])])})),1)],1),e("el-form-item",{attrs:{prop:"srcPath",label:"源目录"}},[null==t.editData.openlistId?e("div",{staticClass:"label_width"},[t._v("请先选择引擎")]):e("div",{staticClass:"label_width"},[t._v(" "+t._s(t.editData.srcPath)+" "),e("el-button",{style:`margin-left: ${""==t.editData.srcPath?0:12}px;`,attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.selectPath(!0)}}},[t._v(t._s(""==t.editData.srcPath?"选择":"更换")+"目录")])],1)]),e("el-form-item",{attrs:{prop:"dstPath",label:"目标目录"}},[null==t.editData.openlistId?e("div",{staticClass:"label_width"},[t._v("请先选择引擎")]):e("div",{staticClass:"label_width"},[e("div",{staticClass:"label-list-box"},[t._l(t.editData.dstPath,(function(a,s){return e("div",{staticClass:"label-list-item"},[e("div",{staticClass:"bg-1 label-list-item-left"},[t._v(" "+t._s(a)+" ")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.delDstPath(s)}}},[t._v("删除")])],1)})),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.selectPath(!1)}}},[t._v(t._s(0==t.editData.dstPath.length?"选择":"添加")+"目录")])],2)])]),e("el-form-item",{attrs:{prop:"remark",label:"作业名称"}},[e("div",{staticClass:"label_width"},[e("el-input",{attrs:{placeholder:"用来标识你的作业，选填"},model:{value:t.editData.remark,callback:function(e){t.$set(t.editData,"remark",e)},expression:"editData.remark"}})],1)]),e("el-form-item",{attrs:{prop:"method",label:"同步方法"}},[e("el-select",{staticClass:"label_width",model:{value:t.editData.method,callback:function(e){t.$set(t.editData,"method",e)},expression:"editData.method"}},[e("el-option",{attrs:{label:"仅新增",value:0}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("仅新增")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("仅新增目标目录没有的文件")])]),e("el-option",{attrs:{label:"全同步",value:1}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("全同步")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("目标目录比源目录多的文件将被删除")])]),e("el-option",{attrs:{label:"移动模式",value:2}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("移动模式")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("同步完成后删除源目录所有文件")])])],1)],1),e("el-form-item",{attrs:{prop:"useCacheT",label:"目标目录扫描缓存"}},[e("el-select",{staticClass:"label_width",model:{value:t.editData.useCacheT,callback:function(e){t.$set(t.editData,"useCacheT",e)},expression:"editData.useCacheT"}},[e("el-option",{attrs:{label:"不使用",value:0}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("不使用")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("如果会对目标目录手动操作，选这个，但更容易被网盘限制")])]),e("el-option",{attrs:{label:"使用",value:1}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("使用")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("推荐，降低网盘风控可能")])])],1)],1),e("el-form-item",{attrs:{prop:"scanIntervalT",label:"目标目录操作间隔"}},[e("el-input",{staticClass:"label_width",attrs:{placeholder:"目标目录操作间隔"},model:{value:t.editData.scanIntervalT,callback:function(e){t.$set(t.editData,"scanIntervalT",t._n(e))},expression:"editData.scanIntervalT"}},[e("template",{slot:"append"},[t._v("秒")])],2)],1),e("el-form-item",{attrs:{prop:"useCacheS",label:"源目录扫描缓存"}},[e("el-select",{staticClass:"label_width",model:{value:t.editData.useCacheS,callback:function(e){t.$set(t.editData,"useCacheS",e)},expression:"editData.useCacheS"}},[e("el-option",{attrs:{label:"不使用",value:0}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("不使用")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("用这个")])]),e("el-option",{attrs:{label:"使用",value:1}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("使用")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("不要用，除非你知道自己在做什么")])])],1)],1),e("el-form-item",{attrs:{prop:"scanIntervalS",label:"源目录操作间隔"}},[e("el-input",{staticClass:"label_width",attrs:{placeholder:"源目录操作间隔"},model:{value:t.editData.scanIntervalS,callback:function(e){t.$set(t.editData,"scanIntervalS",t._n(e))},expression:"editData.scanIntervalS"}},[e("template",{slot:"append"},[t._v("秒")])],2)],1),e("el-form-item",{attrs:{prop:"exclude",label:"排除项语法"}},[e("div",{staticClass:"label_width"},[t._v("类gitignore"),e("br"),e("span",{staticClass:"to-link",on:{click:t.toIgnore}},[t._v(" 点击查看排除项简易教程 ")])])]),e("el-form-item",{attrs:{prop:"exclude",label:"排除项规则"}},[e("div",{staticClass:"label_width"},[e("div",{staticClass:"label-list-box"},[e("el-input",{attrs:{placeholder:"输入后点添加才生效"},model:{value:t.excludeTmp,callback:function(e){t.excludeTmp=e},expression:"excludeTmp"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.addExclude},slot:"append"},[t._v("添加")])],1),t._l(t.editData.exclude,(function(a,s){return e("div",{staticClass:"label-list-item"},[e("div",{staticClass:"bg-3 label-list-item-left"},[t._v(" "+t._s(a)+" ")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.delExclude(s)}}},[t._v("删除")])],1)}))],2)])]),2==t.editData.method?e("span",{staticStyle:{"margin-top":"-12px","margin-left":"410px","margin-bottom":"18px",color:"#f56c6c","font-weight":"bold"}},[t._v("移动模式存在风险，可能导致文件丢失（因为会删除源目录文件），该方法应仅用于不重要的文件或有多重备份的文件！希望你知道自己在做什么！")]):t._e(),e("el-form-item",{attrs:{prop:"isCron",label:"调用方式"}},[e("el-select",{staticClass:"label_width",model:{value:t.editData.isCron,callback:function(e){t.$set(t.editData,"isCron",e)},expression:"editData.isCron"}},[e("el-option",{attrs:{label:"间隔",value:0}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("间隔")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("每n分钟同步一次")])]),e("el-option",{attrs:{label:"cron",value:1}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("cron")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("推荐使用，有教程")])]),e("el-option",{attrs:{label:"仅手动",value:2}},[e("span",{staticStyle:{float:"left","margin-right":"16px"}},[t._v("仅手动")]),e("span",{staticStyle:{float:"right",color:"#7b9dad","font-size":"13px"}},[t._v("不自动调用")])])],1)],1),0==t.editData.isCron?[e("el-form-item",{attrs:{prop:"interval",label:"同步间隔"}},[e("el-input",{staticClass:"label_width",attrs:{placeholder:"请输入同步间隔"},model:{value:t.editData.interval,callback:function(e){t.$set(t.editData,"interval",t._n(e))},expression:"editData.interval"}},[e("template",{slot:"append"},[t._v("分钟")])],2)],1),e("span",{staticStyle:{"margin-left":"100px"}},[t._v("间隔方式不会立即调用，如有需要，可在创建后立即手动调用")])]:1==t.editData.isCron?[e("el-form-item",{attrs:{label:"cron表达式"}},[e("div",{staticClass:"label_width"},[e("el-input",{staticClass:"label_width",attrs:{placeholder:"秒 分 时 日 月 周 或 分 时 日 月 周"},model:{value:t.editData.cronExpr,callback:function(e){t.$set(t.editData,"cronExpr",e)},expression:"editData.cronExpr"}})],1)])]:t._e()],2)]):t._e()],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeShow}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",loading:t.editLoading},on:{click:t.submit}},[t._v("确 定")])],1)]),e("el-dialog",{attrs:{"close-on-click-modal":!1,visible:t.disableShow,"append-to-body":!0,title:"警告",width:"460px","before-close":t.closeDisableShow},on:{"update:visible":function(e){t.disableShow=e}}},[e("div",{staticStyle:{color:"#f56c6c","font-weight":"bold","text-align":"center","font-size":"20px"}},[t._v(" "+t._s(t.disableIsDel?"此操作不可逆，将永久删除该作业":"将禁用任务")+"，确认吗？ ")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeDisableShow}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",loading:t.editLoading},on:{click:t.submitDisable}},[t._v("确 定")])],1)]),t.editData?e("pathSelect",{ref:"pathSelect",attrs:{openlistId:t.editData.openlistId},on:{submit:t.submitPath}}):t._e()],1)},i=[],l=(a("14d9"),a("e9f5"),a("7d54"),a("e9c4"),a("5087"),a("76fe")),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pathSelect"},[e("el-dialog",{attrs:{top:"8vh","close-on-click-modal":!1,visible:t.dialogShow,title:"选择目录",width:"520px","before-close":t.closeShow,"append-to-body":!0},on:{"update:visible":function(e){t.dialogShow=e}}},[t.dialogShow?e("el-tree",{attrs:{props:t.props,load:t.loadNode,lazy:"","highlight-current":!0,"check-on-click-node":!0},on:{"node-click":t.nodeClick}}):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeShow}},[t._v("取 消")]),e("el-button",{attrs:{type:"success",plain:"",disabled:null==t.cuPath},on:{click:t.mkdir}},[t._v("新建文件夹")]),e("el-button",{attrs:{type:"primary",loading:t.submitLoading,disabled:null==t.cuPath},on:{click:t.submit}},[t._v(t._s(null==t.cuPath?"请先选择路径":"确 定"))])],1)],1)],1)},n=[],r={name:"PathSelect",components:{},props:{openlistId:{type:Number,default:null}},data(){return{dialogShow:!1,pathLoading:!1,submitLoading:!1,cuPath:null,cuNode:null,props:{label:"path",children:"child",isLeaf:"leaf"}}},created(){},beforeDestroy(){},methods:{show(){this.dialogShow=!0},async getPath(t){this.pathLoading=!0;try{let e=await Object(l["k"])(this.openlistId,t);return this.pathLoading=!1,e.data}catch(e){return this.pathLoading=!1,[]}},async loadNode(t,e){let a="/",s=t;for(let i=0;i<t.level;i++)a="/"+s.data.path+a,s=s.parent;return e(await this.getPath(a))},closeShow(){this.dialogShow=!1,this.cuPath=null,this.cuNode=null},nodeClick(t,e,a){let s="/",i=e;for(let l=0;l<e.level;l++)s="/"+i.data.path+s,i=i.parent;this.cuPath=s,this.cuNode=e},mkdir(){this.$prompt("请输入文件夹名称","新建文件夹",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[^/\\:*?"<>|]+$/,inputErrorMessage:"文件夹名称格式不正确"}).then(async({value:t})=>{this.submitLoading=!0;try{await Object(l["l"])({id:this.openlistId,path:this.cuPath+t}),this.$message.success("创建成功"),this.cuNode&&(this.cuNode.loaded=!1,this.cuNode.expand())}catch(e){console.error(e)}this.submitLoading=!1}).catch(()=>{})},submit(){this.$emit("submit",this.cuPath),this.closeShow()}}},c=r,d=(a("4b75"),a("2877")),h=Object(d["a"])(c,o,n,!1,null,"14bbc215",null),u=h.exports,p=a("8c11"),b={name:"Home",components:{pathSelect:u,menuRefresh:p["a"]},data(){return{jobData:{jobList:[],count:0},params:{pageSize:10,pageNum:1},openlistList:[],cronList:[{label:"year",palce:"2024"},{label:"month",palce:"1-12"},{label:"day",palce:"1-31"},{label:"week",palce:"1-53"},{label:"day_of_week",palce:"0-6 or mon,tue,wed,thu,fri,sat,sun"},{label:"hour",palce:"0-23"},{label:"minute",palce:"0-59"},{label:"second",palce:"0-59"},{label:"start_date",palce:"2000-01-01"},{label:"end_date",palce:"2040-12-31"}],cuIsSrc:!1,loading:!1,btnLoading:!1,editLoading:!1,editData:null,excludeTmp:"",editShow:!1,disableShow:!1,disableIsDel:!1,disableCu:{id:null,pause:!0},addRule:{srcPath:[{required:!0,message:"请选择来源目录",trgger:"change"}],dstPath:[{type:"array",required:!0,message:"请选择目标目录",trgger:"change"}],openlistId:[{type:"number",required:!0,message:"请选择引擎",trgger:"change"}],scanIntervalT:[{required:!0,pattern:/^(0|[1-9]\d*)$/,message:"必填且须为非负整数",trgger:"blur"}],scanIntervalS:[{required:!0,pattern:/^(0|[1-9]\d*)$/,message:"必填且须为非负整数",trgger:"blur"}]}}},created(){this.getJobList()},beforeDestroy(){},methods:{runAllJob(){this.$confirm("确认执行所有未禁用的作业吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.btnLoading=!0,Object(l["h"])({pause:null}).then(t=>{this.btnLoading=!1,this.$message({message:t.msg,type:"success"})}).catch(t=>{this.btnLoading=!1})})},getJobList(){this.loading=!0,Object(l["c"])(this.params).then(t=>{this.loading=!1,this.jobData={jobList:t.data.jobList,count:t.data.count}}).catch(t=>{this.loading=!1})},selectPath(t){this.cuIsSrc=t,this.$refs.pathSelect.show()},getOpenlistList(){Object(l["j"])().then(t=>{this.openlistList=t.data})},toIgnore(){window.open("https://github.com/syscc/OpenlistSync?tab=readme-ov-file#%E6%8E%92%E9%99%A4%E9%A1%B9%E8%A7%84%E5%88%99%E7%AE%80%E5%8D%95%E8%AF%B4%E6%98%8E","_blank")},putJob(t,e=null){1==t.enable||!1===e?(this.btnLoading=!0,Object(l["h"])({id:t.id,pause:e}).then(a=>{this.btnLoading=!1,this.$message({message:a.msg,type:"success"}),!1!==e?this.detail(t.id):this.getJobList()}).catch(t=>{this.btnLoading=!1})):this.$message.error("如需手动执行，请先启用作业")},disableJobShow(t,e){this.disableIsDel=e,this.disableCu.id=t.id,this.disableShow=!0},editJobShow(t){t.enable&&2!=t.isCron?this.$message.error("禁用作业后才能编辑"):(0==this.openlistList.length&&this.getOpenlistList(),this.excludeTmp="",this.editData=JSON.parse(JSON.stringify(t)),this.editData.dstPath=this.editData.dstPath.split(":"),this.editData.exclude?this.editData.exclude=this.editData.exclude.split(":"):this.editData.exclude=[],this.editShow=!0)},addShow(){0==this.openlistList.length&&this.getOpenlistList();let t={enable:1,remark:"",srcPath:"",dstPath:[],openlistId:null,useCacheT:1,scanIntervalT:1,useCacheS:0,scanIntervalS:0,method:0,interval:1440,isCron:0,exclude:[]};this.cronList.forEach(e=>{t[e.label]=null}),this.editData=t,this.excludeTmp="",this.editShow=!0},closeShow(){this.editShow=!1},closeDisableShow(){this.disableShow=!1,this.disableCu={id:null,pause:!0}},addExclude(){""!=this.excludeTmp&&this.editData.exclude.push(this.excludeTmp),this.excludeTmp=""},delExclude(t){this.editData.exclude.splice(t,1)},delDstPath(t){this.editData.dstPath.splice(t,1)},submit(){this.$refs.jobRule.validate(t=>{if(t){let t=JSON.parse(JSON.stringify(this.editData));for(let e in t)""===t[e]&&(t[e]=null);if(0==t.isCron&&null==t.interval)return void this.$message.error("选择间隔方式时，间隔必填");if(1==t.isCron){let e=this.editData&&this.editData.cronExpr?String(this.editData.cronExpr).trim():"";if(!e)return void this.$message.error("请输入cron表达式");t.cronExpr=e}t.dstPath=t.dstPath.join(":"),t.exclude=t.exclude.join(":"),this.editLoading=!0,Object(l["g"])(t).then(t=>{this.editLoading=!1,this.$message({message:t.msg,type:"success"}),this.closeShow(),this.getJobList()}).catch(t=>{this.editLoading=!1})}})},submitDisable(){this.editLoading=!0,this.disableIsDel?Object(l["a"])(this.disableCu).then(t=>{this.editLoading=!1,this.$message({message:t.msg,type:"success"}),this.getJobList(),this.closeDisableShow()}).catch(t=>{this.editLoading=!1}):Object(l["h"])(this.disableCu).then(t=>{this.editLoading=!1,this.$message({message:t.msg,type:"success"}),this.getJobList(),this.closeDisableShow()}).catch(t=>{this.editLoading=!1})},submitPath(t){this.cuIsSrc?this.editData.srcPath=t:this.editData.dstPath.includes(t)?this.$message({message:"该目录已存在",type:"error"}):this.editData.dstPath.push(t)},detail(t){this.$router.push({path:"/home/task",query:{jobId:t}})},handleSizeChange(t){this.params.pageSize=t,this.getJobList()},handleCurrentChange(t){this.params.pageNum=t,this.getJobList()}}},m=b,f=(a("151a"),Object(d["a"])(m,s,i,!1,null,null,null));e["default"]=f.exports},"9fef":function(t,e,a){}}]);